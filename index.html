<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C++Insights: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
    <div id="logo"><img alt="Logo" src="logo.png"/></div>
    <div id="projectname"><a href="index.html">C++Insights <span id="projectnumber"></span></a></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">C++Insights Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="artwork/logo_cppinsights.png"  alt="cpp insights logo"/>
</div>
 <h1>C++ Insights - See your source code with the eyes of a compiler.</h1>
<p><a href="https://opensource.org/licenses/MIT">![License](https://img.shields.io/badge/license-MIT-blue.svg)</a> <a href="https://github.com/andreasfertig/cppinsights/releases">![download](https://img.shields.io/badge/latest-download-blue.svg)</a> <a href="https://travis-ci.org/andreasfertig/cppinsights">![Build Status](https://api.travis-ci.org/andreasfertig/cppinsights.svg?branch=master)</a> <a href="https://codecov.io/gh/andreasfertig/cppinsights">![codecov](https://codecov.io/gh/andreasfertig/cppinsights/branch/master/graph/badge.svg)</a> <a href="https://cppinsights.io">![Try online](https://img.shields.io/badge/try-online-blue.svg)</a> <a href="https://www.patreon.com/cppinsights">![patreon](https://img.shields.io/badge/patreon-support-orange.svg)</a></p>
<h2>Contents</h2>
<ul>
<li><a href="#what">What</a></li>
<li><a href="#why">Why</a></li>
<li><a href="#building">Building</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#getinvolved">Get Involved</a></li>
<li><a href="#support">Support</a></li>
</ul>
<h2>What</h2>
<p><a href="https://cppinsights.io">C++ Insights</a> is a <a href="https://clang.llvm.org">clang</a>-based tool which does a source to source transformation. Its goal is it to make things visible which normally, and intentionally, happen behind the scenes. It's about the magic the compiler does for us to make things work.</p>
<p>Take this piece of code for example:</p>
<p>```C++ class Base { };</p>
<p>class Derived : public Base { };</p>
<p>int <a class="el" href="Insights_8cpp.html#a217dbf8b442f20279ea00b898af96f52">main()</a> { Derived d; Base&amp; b = d; } ```</p>
<p>Nothing special and of course it compiles. This is the compilers view on it:</p>
<p>```C++ class Base { /* public: inline constexpr Base() noexcept; /* public: inline ~Base(); /* public: inline constexpr Base(const Base &amp;); /* public: inline constexpr Base(Base &amp;&amp;); };</p>
<p>class Derived : public Base { /* public: inline constexpr Derived() noexcept; /* public: inline constexpr Derived(const Derived &amp;); /* public: inline constexpr Derived(Derived &amp;&amp;); };</p>
<p>int <a class="el" href="Insights_8cpp.html#a217dbf8b442f20279ea00b898af96f52">main()</a>{ Derived d; Base&amp; b = static_cast&lt;Base&amp;&gt;(d); } ```</p>
<p>You can see all the compiler provided functions. Also the downcast from <code>Derived</code> to <code>Base</code>.</p>
<p>I do not claim to get all the things right. This is just the initial version of insights I consider good enough to hand it to the public. Keep also in mind that is solely based on clang and it's understanding of the AST.</p>
<h2>Why</h2>
<p><a href="https://cppinsights.io">C++ Insights</a> is a <a href="https://clang.llvm.org">clang</a>-based tool which does a source to source transformation. Its goal is to make things visible which normally, and intentionally, happen behind the scenes. It's about the magic the compiler does for us to make things work. Or looking through the classes of a compiler.</p>
<p>Some time ago I started looking into some new things we got with C++11, C++14 and C++17. Amazing things like lambdas, range-based for-loops and structured bindings. I put it together in a talk. You can find the <a href="https://www.andreasfertig.info/talks_dl/afertig-ndcolo-2017-fast-and-small.pdf">slides</a> and a <a href="https://youtu.be/Bt7KzFxcbgc">video</a> online.</p>
<p>However, all that research and some of my training and teaching got me start thinking how it would be, if we could see with the eyes of the compiler. Sure, there is an AST-dump at least for clang. With tools like Compiler Explorer we can see what code the compiler generates from a C++ source snippet. However, what we see is assembler. Neither the AST nor the Compiler Explorer output is in the language I write code and therefore I'm most familiar with. Plus when teaching students C++ showing an AST and explaining that it is all there, was not quite satisfying for me.</p>
<p>I started to write a clang-based tool able to transform a range-based for-loop into the compiler-internal version. Then, I did the same for structured bindings and lambdas. In the end, I ended up with doing a lot more as initially planned. It shows where operators are invoked, places in which the compiler does some casting. C++ Insights is able to deduce the type behind <code>auto</code> or <code>decltype</code>. The goal is to produce compilable code. However, this is not possible in all places.</p>
<p>Still, there is work to do.</p>
<p>I do not claim to get all the things right. This is just the initial version of <a href="https://cppinsights.io">C++ Insights</a> I consider good enough to hand it to the public. Also, keep in mind that it is solely based on clang and my understanding of C++ and the AST.</p>
<p>You can see, for example the transformation of a <a href="https://cppinsights.io/lnk?code=aW50IG1haW4oKQp7CiAgaW50ICgqZnApKGludCwgY2hhcikgPSBbXShpbnQgYSwgY2hhciBiKXsgcmV0dXJuIGErYjt9Owp9&amp;rev=1.0">lamda</a>, <a href="https://cppinsights.io/lnk?code=I2luY2x1ZGUgPGNzdGRpbz4KCmludCBtYWluKCkKewogICAgY29uc3QgY2hhciBhcnJbXXsyLDQsNiw4LDEwfTsKCiAgICBmb3IoY29uc3QgY2hhciYgYyA6IGFycikKICAgIHsKICAgICAgcHJpbnRmKCJjPSVjXG4iLCBjKTsKICAgIH0KfQ==&amp;rev=1.0">range-based for-loop</a> or <a href="https://cppinsights.io/lnk?code=Y2xhc3MgQ1Rlc3QKewogICAgYXV0byBUZXN0KCkgeyByZXR1cm4gMjI7IH0KfTsKCmF1dG8gVGVzdCgpCnsKICAgIHJldHVybiAxOwp9CgphdXRvIEJlc3QoKSAtPiBpbnQKewogICAgcmV0dXJuIDE7Cn0KCmNvbnN0ZXhwciBhdXRvIENFQmVzdCgpIC0+IGludAp7CiAgICByZXR1cm4gMTsKfQoKZGVjbHR5cGUoYXV0bykgV2VzdCgpCnsKICAgIHJldHVybiAnYyc7Cn0KCmNvbnN0ZXhwciBkZWNsdHlwZShhdXRvKSBDRVdlc3QoKQp7CiAgICByZXR1cm4gJ2MnOwp9CgpbW21heWJlX3VudXNlZF1dIGlubGluZSBjb25zdGV4cHIgZGVjbHR5cGUoYXV0bykgTVVDRVdlc3QoKQp7CiAgICByZXR1cm4gJ2MnOwp9CgoKaW50IG1haW4oKQp7CiAgaW50IHggPSAyOwogIGNvbnN0IGNoYXIqIHA7CiAgY29uc3RleHByIGF1dG8gY2VpID0gMDsKICBhdXRvIGNvbnN0ZXhwciBjZWkyID0gMDsKICBhdXRvIGkgPSAwOwogIGRlY2x0eXBlKGF1dG8pIHhYID0gKGkpOwogIGF1dG8gaWkgPSAmaTsKICBhdXRvJiBpciA9IGk7CiAgYXV0byAqIGlwID0gJmk7CiAgY29uc3QgYXV0byAqIGNpcCA9ICZpOwogIGF1dG8gKiBwcCA9IHA7CiAgY29uc3QgYXV0byAqIGNwID0gcDsKICB2b2xhdGlsZSBjb25zdCBhdXRvICogdmNwID0gcDsKICBhdXRvIGYgPSAxLjBmOwogIGF1dG8gYyA9ICdjJzsKICBhdXRvIHUgPSAwdTsKICBkZWNsdHlwZSh1KSB1dSA9IHU7CgogIFtbbWF5YmVfdW51c2VkXV0gYXV0byBtdSA9IDB1OwogIFtbbWF5YmVfdW51c2VkXV0gZGVjbHR5cGUodSkgbXV1ID0gdTsKfQ==&amp;rev=1.0">auto</a>. Of course, you can transform any other C++ snippet.</p>
<p>See yourself, C++ Insights is available online: <a href="https://cppinsights.io">cppinsights.io</a>.</p>
<h2>Building</h2>
<p>C++ Insights can be build inside the clang-source tree or outside.</p>
<h3>Building outside clang</h3>
<p>You need to have a clang installation in the search path.</p>
<p>``` git clone <a href="https://github.com/andreasfertig/cppinsights.git">https://github.com/andreasfertig/cppinsights.git</a> mkdir build &amp;&amp; cd build cmake -G"Ninja" ../cppinsights ninja ``` The resulting binary (insights) can be found in the build-folder.</p>
<h3>Building inside clang</h3>
<p>For building it inside the clang-source tree, assuming you have your source-tree already prepared:</p>
<p>``` cd llvm/tools/clang/tools/extra git clone <a href="https://github.com/andreasfertig/cppinsights.git">https://github.com/andreasfertig/cppinsights.git</a></p>
<p>echo "add_subdirectory(cppinsights)" &gt;&gt; CMakeLists.txt ```</p>
<p>Then build clang as you normally do.</p>
<h3>cmake options</h3>
<p>There are a couple of options which can be enable with <a href="https://cmake.org">!cmake</a>:</p>
<table class="doxtable">
<tr>
<th>Option </th><th align="left">Description </th><th>Default  </th></tr>
<tr>
<td>INSIGHTS_STRIP </td><td align="left">Strip insight after build </td><td>ON </td></tr>
<tr>
<td>INSIGHTS_STATIC </td><td align="left">Use static linking </td><td>OFF </td></tr>
<tr>
<td>INSIGHTS_COVERAGE </td><td align="left">Enable code coverage </td><td>OFF </td></tr>
<tr>
<td>DEBUG </td><td align="left">Enable debug </td><td>OFF </td></tr>
</table>
<h3>Use it with <a href="https://www.cevelop.com">Cevelop</a></h3>
<p>``` git clone <a href="https://github.com/andreasfertig/cppinsights.git">https://github.com/andreasfertig/cppinsights.git</a> mkdir build_eclipse cd build_eclipse cmake -G"Eclipse CDT4 - Unix Makefiles" ../cppinsights/ ```</p>
<p>Then in <a href="https://www.cevelop.com">Cevelop</a> Import -&gt; General -&gt; Existing Project into Workspace. Select <code>build_eclipse</code>. Enjoy editing with <a href="https://www.cevelop.com">Cevelop</a>.</p>
<h2>Usage</h2>
<p>Using C++ Insights is fairly simple:</p>
<p>``` insights &lt;YOUR_CPP_FILE&gt; &ndash; -std=c++17 ```</p>
<p>Things get complicate with when it comes to the system include paths. There are path hard-coded in the binary which seem to come from the compiler C++ Insights was build with. To help with that check out <a href="scripts/getinclude.py">scripts/getinclude.py</a>. It tries to collect the system include paths from the compiler. Without an option it uses <code>g++</code>, you can also pass another compiler as a first argument.</p>
<p>Here is an example:</p>
<p>``` ./scripts/getinclude.py -isystem/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../include/c++/v1 -isystem/usr/local/include -isystem/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../lib/clang/7.3.0/include -isystem/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include -isystem/usr/include ```</p>
<p>The script can be used together with C++ Insights:</p>
<p>``<code> insights &lt;YOUR_CPP_FILE&gt; -- -std=c++17</code>./scripts/getinclude.py<code> </code>``</p>
<p>There is also another github project which sets up a docker container with the latest C++ Insights version in it: <a href="https://github.com/andreasfertig/cppinsights-docker">C++ Insights - Docker</a></p>
<h2>Get Involved</h2>
<ul>
<li>Report bugs/issues by submitting a <a href="https://github.com/andreasfertig/cppinsights/issues">Github issue</a>.</li>
<li>Submit contributions using <a href="https://github.com/andreasfertig/cppinsights/pulls">pull requests</a>. See <a class="el" href="CONTRIBUTING_8md.html">Contributing</a></li>
</ul>
<h2>Support</h2>
<p>If you like to support the project consider <a class="el" href="CONTRIBUTING_8md.html">submitting</a> a patch. Another alternative is to become a <a href="https://www.patreon.com/cppinsights">Patreon</a> supporter. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html"></a> 1.8.6
</small></address>
</body>
</html>
