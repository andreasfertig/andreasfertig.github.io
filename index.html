<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C++ Insights: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"  class="clearfix"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
    <a href="index.html">
        <div class="title-and-logo">
            <div id="logo"><img alt="C++ Insights Logo" src="logo.png"/></div>
        </div>
    </a>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">C++ Insights Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_Readme"></a> <img src="logo_cppinsights.png" alt="" class="inline" title="cpp insights logo"/> </p>
<h1><a class="anchor" id="autotoc_md22"></a>
C++ Insights - See your source code with the eyes of a compiler.</h1>
<p><a target="_blank" href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License" style="pointer-events: none;" class="inline"/></a> <a target="_blank" href="https://github.com/andreasfertig/cppinsights/releases"><img src="https://img.shields.io/badge/latest-download-blue.svg" alt="download" style="pointer-events: none;" class="inline"/></a> <a target="_blank" href="https://github.com/andreasfertig/cppinsights/actions/"><img src="https://github.com/andreasfertig/cppinsights/workflows/ci/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a> <a target="_blank" href="https://codecov.io/gh/andreasfertig/cppinsights"><img src="https://codecov.io/gh/andreasfertig/cppinsights/branch/master/graph/badge.svg" alt="codecov" style="pointer-events: none;" class="inline"/></a> <a target="_blank" href="https://cppinsights.io"><img src="https://img.shields.io/badge/try-online-blue.svg" alt="Try online" style="pointer-events: none;" class="inline"/></a> <a target="_blank" href="https://docs.cppinsights.io"><img src="https://img.shields.io/badge/view-documentation-blue" alt="Documentation" class="inline"/></a> <a target="_blank" href="https://www.patreon.com/cppinsights"><img src="https://img.shields.io/badge/patreon-support-orange.svg" alt="patreon" style="pointer-events: none;" class="inline"/></a></p>
<p><a target="_blank" href="https://gitpod.io#https://github.com/andreasfertig/cppinsights"><img src="https://gitpod.io/button/open-in-gitpod.svg" alt="Open in Gitpod" style="pointer-events: none;" class="inline"/></a></p>
<h2><a class="anchor" id="autotoc_md23"></a>
Contents</h2>
<ul>
<li><a href="#what">What</a></li>
<li><a href="#why">Why</a></li>
<li><a href="#building">Building</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#getinvolved">Get Involved</a></li>
<li><a href="#support">Support</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md24"></a>
What</h2>
<p><a target="_blank" href="https://cppinsights.io">C++ Insights</a> is a <a target="_blank" href="https://clang.llvm.org">Clang</a>-based tool that does a source-to-source transformation. The goal of C++ Insights is to make things visible that normally and intentionally happen behind the scenes. It's about the magic the compiler does for us to make things work.</p>
<p>Take this piece of code for example:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Base {</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Derived : <span class="keyword">public</span> Base {</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="_option_documentation_generator_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div>
<div class="line">  Derived d;</div>
<div class="line">  Base&amp; b = d;</div>
<div class="line">}</div>
<div class="ttc" id="a_option_documentation_generator_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="_option_documentation_generator_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="_option_documentation_generator_8cpp_source.html#l00046">OptionDocumentationGenerator.cpp:46</a></div></div>
</div><!-- fragment --><p>Nothing special and of course it compiles. This is the compilers view on it:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Base {</div>
<div class="line"><span class="comment">/* public: inline constexpr Base() noexcept; */</span></div>
<div class="line"><span class="comment">/* public: inline ~Base(); */</span></div>
<div class="line"><span class="comment">/* public: inline constexpr Base(const Base &amp;); */</span></div>
<div class="line"><span class="comment">/* public: inline constexpr Base(Base &amp;&amp;); */</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Derived : <span class="keyword">public</span> Base {</div>
<div class="line"><span class="comment">/* public: inline constexpr Derived() noexcept; */</span></div>
<div class="line"><span class="comment">/* public: inline constexpr Derived(const Derived &amp;); */</span></div>
<div class="line"><span class="comment">/* public: inline constexpr Derived(Derived &amp;&amp;); */</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="_option_documentation_generator_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(){</div>
<div class="line">  Derived d;</div>
<div class="line">  Base&amp; b = <span class="keyword">static_cast&lt;</span>Base&amp;<span class="keyword">&gt;</span>(d);</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can see all the compiler-provided functions as well as the downcast from <code>Derived</code> to <code>Base</code>.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
Why</h2>
<p><a target="_blank" href="https://cppinsights.io">C++ Insights</a> is a <a target="_blank" href="https://clang.llvm.org">Clang</a>-based tool that does a source-to-source transformation. The goal of C++ Insights is to make things visible that normally and intentionally happen behind the scenes. It's about the magic the compiler does for us to make things work. Or looking through the classes of a compiler.</p>
<p>In 2017 I started looking into some new things we got with C++11, C++14, and C++17. Amazing things like lambdas, range-based for-loops, and structured bindings. I put it together in a talk. You can find the <a target="_blank" href="https://andreasfertig.com/talks/dl/afertig-ndcolo-2017-fast-and-small.pdf">slides</a> and a <a target="_blank" href="https://youtu.be/Bt7KzFxcbgc">video</a> online.</p>
<p>However, all that research and some of my training and teaching got me to start thinking about how it would be if we could see with the eyes of the compiler. Sure, there is an AST dump, at least for Clang. With tools like Compiler Explorer, we can see what code the compiler generates from a C++ source snippet. However, what we see is assembler. Neither the AST nor the Compiler Explorer output is in the language I write code, and therefore I'm most familiar with. Plus, when teaching students C++ showing an AST and explaining that it is all there was not quite satisfying for me.</p>
<p>I started to write a Clang-based tool that can transform a range-based for-loop into the compiler-internal version. Then, I did the same for structured bindings and lambdas. In the end, I did much more than initially planned. It shows where operators are invoked and places in which the compiler does some casting. C++ Insights can deduce the type behind <code>auto</code> or <code>decltype</code>. The goal is to produce compilable code. However, this is not possible in all places.</p>
<p>You can see, for example, the transformation of a <a target="_blank" href="https://cppinsights.io/s/e4e19791">lambda</a>, <a target="_blank" href="https://cppinsights.io/s/0cddd172">range-based for-loop</a>, or <a target="_blank" href="https://cppinsights.io/s/6c61d601">auto</a>. Of course, you can transform any other C++ snippet.</p>
<p>See yourself. C++ Insights is available online: <a target="_blank" href="https://cppinsights.io">cppinsights.io</a>.</p>
<p>Still, there is work to do.</p>
<p>I do not claim to get all the things right. I'm also working on supporting features from new standards, like C++20, at the moment. Please remember that C++ Insights is based on Clang and its understanding of the AST.</p>
<p>I did a couple of talks about C++ Insights since I released C++ Insights. For example, at C++ now. Here are the <a target="_blank" href="https://andreasfertig.com/talks/dl/afertig-2021-cppnow-cpp-insights.pdf">slides</a> and the <a target="_blank" href="https://youtu.be/p-8wndrTaTs">video</a>.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Building</h2>
<p>C++ Insights can be built inside the Clang source tree or outside.</p>
<h3><a class="anchor" id="autotoc_md27"></a>
Building on Windows</h3>
<p>See <a class="el" href="building_on_windows.html#md_Readme_Windows">Readme_Windows.md</a></p>
<h3><a class="anchor" id="autotoc_md28"></a>
Building on Arch Linux</h3>
<p>To build with <code>extra/clang</code> use the following extra flags: <code>-DINSIGHTS_USE_SYSTEM_INCLUDES=off -DCLANG_LINK_CLANG_DYLIB=on -DLLVM_LINK_LLVM_DYLIB=on</code></p>
<p>See <a target="_blank" href="https://github.com/andreasfertig/cppinsights/issues/186">https://github.com/andreasfertig/cppinsights/issues/186</a> for an explanation of why <code>INSIGHTS_USE_SYSTEM_INCLUDES</code> needs to be turned off.</p>
<p><code>extra/clang</code> and <code>extra/llvm</code> provide <code>/usr/lib/{libclangAST.so,libLLVM*.a,libLLVM.so}</code>. <code>libclangAST.so</code> needs <code>libLLVM.so</code> and there would be a conflict if <code>libLLVM*.a</code> (instead of <code>libLLVM.so</code>) are linked. See <a target="_blank" href="https://bugs.archlinux.org/task/60512">https://bugs.archlinux.org/task/60512</a></p>
<h3><a class="anchor" id="autotoc_md29"></a>
Building outside Clang</h3>
<p>You need to have a Clang installation in the search path.</p>
<div class="fragment"><div class="line">git clone https://github.com/andreasfertig/cppinsights.git</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake -G&quot;Ninja&quot; ../cppinsights</div>
<div class="line">ninja</div>
</div><!-- fragment --><p> The resulting binary (insights) can be found in the build-folder.</p>
<h3><a class="anchor" id="autotoc_md30"></a>
Building inside Clang</h3>
<p>For building it inside the Clang source tree, assuming you have your source tree already prepared:</p>
<div class="fragment"><div class="line">cd llvm/tools/clang/tools/extra</div>
<div class="line">git clone https://github.com/andreasfertig/cppinsights.git</div>
<div class="line"> </div>
<div class="line">echo &quot;add_subdirectory(cppinsights)&quot; &gt;&gt; CMakeLists.txt</div>
</div><!-- fragment --><p>Then build Clang as you normally do.</p>
<h3><a class="anchor" id="autotoc_md31"></a>
cmake options</h3>
<p>There are a couple of options which can be enable with <a target="_blank" href="https://cmake.org">cmake</a>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadNone">Default    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">INSIGHTS_STRIP   </td><td class="markdownTableBodyLeft">Strip insight after build   </td><td class="markdownTableBodyNone">ON    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">INSIGHTS_STATIC   </td><td class="markdownTableBodyLeft">Use static linking   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">INSIGHTS_COVERAGE   </td><td class="markdownTableBodyLeft">Enable code coverage   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">INSIGHTS_USE_LIBCPP   </td><td class="markdownTableBodyLeft">Use libc++ for tests   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DEBUG   </td><td class="markdownTableBodyLeft">Enable debug   </td><td class="markdownTableBodyNone">OFF   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md32"></a>
Use it with &lt;a target="_blank" href="https://www.cevelop.com"&gt;Cevelop&lt;/a&gt;</h3>
<div class="fragment"><div class="line">git clone https://github.com/andreasfertig/cppinsights.git</div>
<div class="line">mkdir build_eclipse</div>
<div class="line">cd build_eclipse</div>
<div class="line">cmake -G&quot;Eclipse CDT4 - Unix Makefiles&quot; ../cppinsights/</div>
</div><!-- fragment --><p>Then in <a target="_blank" href="https://www.cevelop.com">Cevelop</a> Import -&gt; General -&gt; Existing Project into Workspace. Select <code>build_eclipse</code>. Enjoy editing with <a target="_blank" href="https://www.cevelop.com">Cevelop</a>.</p>
<h2><a class="anchor" id="autotoc_md33"></a>
Usage</h2>
<p>Using C++ Insights is fairly simple:</p>
<div class="fragment"><div class="line">insights &lt;YOUR_CPP_FILE&gt; -- -std=c++17</div>
</div><!-- fragment --><p>Things get complicated when it comes to the system include paths. These paths are hard-coded in the binary, which seems to come from the compiler C++ Insights was built with. To help with that, check out <a href="scripts/getinclude.py">scripts/getinclude.py</a>. The script tries to collect the system include paths, from the compiler. Without an option, <code><a class="el" href="getinclude_8py.html">getinclude.py</a></code> uses <code>g++</code>. You can also pass another compiler as a first argument.</p>
<p>Here is an example:</p>
<div class="fragment"><div class="line">./scripts/getinclude.py</div>
<div class="line">-isystem/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../include/c++/v1 -isystem/usr/local/include -isystem/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../lib/clang/7.3.0/include -isystem/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include -isystem/usr/include</div>
</div><!-- fragment --><p>The script can be used together with C++ Insights:</p>
<div class="fragment"><div class="line">insights &lt;YOUR_CPP_FILE&gt; -- -std=c++17 `./scripts/getinclude.py`</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md34"></a>
Custom GCC installation</h3>
<p>In case you have a custom build of the GCC compiler, for example, gcc-11.2.0, and <em>NOT</em> installed in the compiler in the default system path, then after building, Clang fails to find the correct <code>libstdc++</code> path (GCC's STL). If you run into this situation, you can use "`--gcc-toolchain=/path/GCC-1x.x.x/installed/path`" to tell Clang/C++ Insights the location of the STL:</p>
<div class="fragment"><div class="line">./cppinsights Insights.cpp -- --gcc-toolchain=${GCC_11_2_0_INSTALL_PATH} -std=c++20</div>
</div><!-- fragment --><p>Here "`${GCC_11_2_0_INSTALL_PATH}`" is the installation directory of your customized-built GCC. The option for Clang is described <a target="_blank" href="https://clang.llvm.org/docs/ClangCommandLineReference.html#cmdoption-clang-gcc-toolchain">here</a>.</p>
<h3><a class="anchor" id="autotoc_md35"></a>
Ready to use Docker container</h3>
<p>There is also another GitHub project which sets up a docker container with the latest C++ Insights version in it: <a target="_blank" href="https://github.com/andreasfertig/cppinsights-docker">C++ Insights - Docker</a></p>
<h3><a class="anchor" id="autotoc_md36"></a>
C++ Insights @ Vim</h3>
<p>A plugin for Vim is available at <a target="_blank" href="https://github.com/Freed-Wu/cppinsights.vim">here</a>.</p>
<h3><a class="anchor" id="autotoc_md37"></a>
C++ Insights @ VSCode</h3>
<p>An extension for Visual Studio Code is available at the VS Code marketplace: <a target="_blank" href="https://marketplace.visualstudio.com/items?itemName=devtbi.vscode-cppinsights">C++ Insights - VSCode Extension</a>.</p>
<h2><a class="anchor" id="autotoc_md38"></a>
Compatibility</h2>
<p>I aim that the repository compiles with the latest version of Clang and at least the one before. The website tries to stay close to the latest release of Clang. However, due to certain issues (building Clang for Windows), the website's version is often delayed a few months.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
C++ Insights @ YouTube</h2>
<p>I created a <a target="_blank" href="https://www.youtube.com/c/AndreasFertig-info">YouTube</a> channel where I release a new video each month. In these videos, I use C++ Insights to show and explain certain C++ constructs, and sometimes I explain C++ Insights as well.</p>
<h2><a class="anchor" id="autotoc_md40"></a>
ToDo's</h2>
<p>See <a class="el" href="todo.html#md_TODO">TODO</a>.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
Get Involved</h2>
<ul>
<li>Report bugs/issues by submitting a <a target="_blank" href="https://github.com/andreasfertig/cppinsights/issues">GitHub issue</a>.</li>
<li>Submit contributions using <a target="_blank" href="https://github.com/andreasfertig/cppinsights/pulls">pull requests</a>. See <a class="el" href="contributing.html#md_CONTRIBUTING">Contributing</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md42"></a>
Support</h2>
<p>If you like to support the project, consider <a class="el" href="contributing.html#md_CONTRIBUTING">submitting</a> a patch. Another alternative is to become a <a target="_blank" href="https://www.patreon.com/cppinsights">Patreon</a> supporter. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a target="_blank" href="http://www.doxygen.org/index.html"></a> 1.9.1
</small></address>
</body>
</html>
